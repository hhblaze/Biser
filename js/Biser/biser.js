var Biser=function(){var t=this;this.RootBiser=this,this.ear=[],this.earPos=-1,this.decPos=-1,this.qb=0,this.IsNull=function(){return 1==this.GetDigit()},this.ELong=function(t){return this.GetVarintBytes(this.EncodeZigZag(t,64)),this},this.DLong=function(){return this.DecodeZigZag(this.GetDigit())},this.ELong=function(t){return this.GetVarintBytes(this.EncodeZigZag(t,64)),this},this.EBool=function(t){return this.GetVarintBytes(1==t?1:0),this},this.DBool=function(){return 1==this.GetDigit()},this.EDate=function(i){return t.ELong(i.getTime()),this},this.DDate=function(){return new Date(t.DLong())},this.EDouble=function(t){var i=new ArrayBuffer(8);new Float64Array(i)[0]=t;var o=new Int8Array(i);this.RootBiser.ear[++this.RootBiser.earPos]=1==IsBigEndian()?1:0;for(var r=0;r<o.length;r++)this.RootBiser.ear[++this.RootBiser.earPos]=o[r];return this},this.DDouble=function(){var t=new ArrayBuffer(8),i=new Int8Array(t);if(0==this.ReadNext())for(var o=0;o<i.length;o++)i[o]=this.ReadNext();else for(o=i.length-1;o>=0;o--)i[o]=this.ReadNext();return new Float64Array(t)[0]},this.EString=function(i){for(var o=[],r=0;r<i.length;r++)o[r]=i.charCodeAt(r);return this.EArray(o,function(i){t.ELong(i)}),this},this.DString=function(){for(var i=this.DArray(function(){return t.DLong()}),o=[],r=0;r<i.length;r++)o.push(String.fromCharCode(i[r]));return o.join("")},this.EUint8Array=function(i){if(t.ELong(i.length),i.length>0)for(var o=0;o<i.length;o++)this.RootBiser.ear[++this.RootBiser.earPos]=i[o];return this},this.DUint8Array=function(){var i=t.DLong(),o=new ArrayBuffer(i),r=new Uint8Array(o);if(i>0)for(var e=0;e<i;e++)r[e]=this.ReadNext();return r},this.EArray=function(t,i){if(t&&t.length>0){this.RootBiser.ear[++this.RootBiser.earPos]=0;var o=++this.RootBiser.earPos;this.RootBiser.ear[o]=0;for(var r=0;r<t.length;r++)i(t[r]);var e=this.RootBiser.earPos-o,n=e>268435455?5:e>2097151?4:e>16383?3:e>127?2:1,s=0;if(n>1){for(var h=n-1,a=0;a<h;a++)this.RootBiser.ear[++this.RootBiser.earPos]=this.RootBiser.ear[o+1+a];s=this.RootBiser.earPos,this.RootBiser.earPos=o-1,this.GetVarintBytes(e),this.RootBiser.earPos=s}else s=this.RootBiser.earPos,this.RootBiser.earPos=o-1,this.GetVarintBytes(e),this.RootBiser.earPos=s}else this.RootBiser.ear[++this.RootBiser.earPos]=1;return this},this.DArray=function(t){var i=[];if(0==this.ReadNext()){var o=this.GetDigit(),r=this.RootBiser.decPos,e=0;this.collectionShift=0;var n=this.RootBiser.qb,s=null,h=null;for(n>1&&(s=this.RootBiser.collectionShift,h=this.RootBiser.collectionLen,this.RootBiser.collectionShift=this.RootBiser.qb-1,this.RootBiser.collectionLen=o);o-(this.RootBiser.decPos-r+(n-1))>0;)i[e]=t(),e++;n>1&&(this.RootBiser.collectionShift=s,this.RootBiser.collectionLen=h,this.RootBiser.decPos+=n-1)}return i},this.collectionShift=0,this.collectionLen=0,this.ReadNext=function(){var t=0;return this.RootBiser.collectionShift>0?(t=this.RootBiser.ear[this.RootBiser.decPos+this.RootBiser.collectionLen+1-this.RootBiser.collectionShift],this.RootBiser.collectionShift--):t=this.RootBiser.ear[++this.RootBiser.decPos],t},longShiftLeft=function(t,i){var o=Math.pow(2,i);return Math.floor(t*o)},longShiftRight=function(t,i){var o=Math.pow(2,i);return Math.floor(t/o)},IsBigEndian=function(){return 18===new Uint8Array(new Uint32Array([305419896]).buffer)[0]};var i=2147483648,o=2147483647;longAnd=function(t,r){var e=~~(t/i)&~~(r/i),n=t&o&(r&o);return Math.floor(e*i+n)},longOr=function(t,r){var e=~~(t/i)|~~(r/i),n=t&o|r&o;return Math.floor(e*i+n)},longXOr=function(t,r){var e=~~(t/i)^~~(r/i),n=t&o^r&o;return Math.floor(e*i+n)},this.EncodeZigZag=function(t,i){return t>=0?longShiftLeft(t,1):longShiftLeft(-1*t,1)-1},this.DecodeZigZag=function(t){return 1==longAnd(t,1)?-1*(longShiftRight(t,1)+1):longShiftRight(t,1)},this.GetDigit=function(){var t=0,i=0,o=0;for(this.RootBiser.qb=0;;){if(t=this.ReadNext(),i=longOr(i,longShiftLeft(longAnd(t,127),o)),this.RootBiser.qb++,128!=(128&t))return i;o+=7}},this.GetVarintBytes=function(t){var i;do{i=longAnd(t,127),0!=(t=longShiftRight(t,7))&&(i|=128),this.RootBiser.ear[++this.RootBiser.earPos]=i}while(0!=t)},GetVarintBytesInternal=function(t,i,o){var r;do{r=longAnd(t,127),0!=(t=longShiftRight(t,7))&&(r|=128),i[o++]=r}while(0!=t);return o},this.Final=function(){console.log("---");for(var t=0;t<this.RootBiser.ear.length;t++)console.log("Entry "+t+": "+this.RootBiser.ear[t])}};